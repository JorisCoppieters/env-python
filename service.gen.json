{
    "docker": {
        "container": {
            "ports": [
                {
                    "container": 8888,
                    "host": 8888,
                    "test": true
                }
            ],
            "volumes": [
                {
                    "container": "/root/corpus",
                    "host": "./corpus"
                },
                {
                    "container": "/root/models",
                    "host": "./models"
                },
                {
                    "container": "/root/scripts",
                    "host": "./scripts"
                },
                {
                    "container": "/root/downloads",
                    "host": "./downloads"
                }
            ]
        },
        "image": {
            "base": "ubuntu:xenial",
            "env_variables": [
                {
                    "key": "BASE_DIR",
                    "val": "/root"
                },
                {
                    "key": "DOWNLOADS_DIR",
                    "val": "$BASE_DIR/downloads"
                },
                {
                    "key": "LIBRARIES_DIR",
                    "val": "$BASE_DIR/libraries"
                }
            ],
            "ignore": [
                "corpus/*",
                "models/*",
                "scripts/*",
                "downloads/*"
            ],
            "name": "env-python",
            "operations": [
                {
                    "commands": [
                        "sed 's@archive.ubuntu.com@nz.archive.ubuntu.com@' -i /etc/apt/sources.list"
                    ],
                    "description": "Switching apt-get mirrors to NZ",
                    "type": "commands"
                },
                {
                    "description": "Installing dependencies",
                    "packages": [
                        "git",
                        "nano",
                        "libav-tools",
                        "ffmpeg",
                        "python",
                        "python-dev",
                        "python-numpy",
                        "python-pip",
                        "python-yaml",
                        "python-tk",
                        "python-opencv",
                        "python-sklearn"
                    ],
                    "packages_source": "apt-get",
                    "type": "packages",
                    "update": true
                },
                {
                    "packages": [
                        "Cython>=0.19.2",
                        "eyed3",
                        "flask",
                        "flask_cors",
                        "h5py>=2.2.0",
                        "hmmlearn",
                        "ipython<=5.0.0",
                        "jupyter",
                        "leveldb>=0.191",
                        "matplotlib>=1.3.1",
                        "networkx>=1.8.1",
                        "nose>=1.3.0",
                        "numpy>=1.7.1",
                        "pandas>=0.12.0",
                        "Pillow>=2.3.0",
                        "protobuf>=2.5.0",
                        "psutil",
                        "pydub",
                        "python-dateutil>=1.4,<2",
                        "python-gflags>=2.0",
                        "pyyaml>=3.10",
                        "scikit-image>=0.9.3",
                        "scipy>=0.13.2",
                        "simplejson",
                        "six>=1.1.0",
                        "sklearn"
                    ],
                    "packages_source": "pip",
                    "type": "packages",
                    "update": true
                },
                {
                    "description": "Creating folders",
                    "path": "$DOWNLOADS_DIR",
                    "type": "folder"
                },
                {
                    "path": "$LIBRARIES_DIR",
                    "type": "folder"
                },
                {
                    "commands": [
                        "git clone https://github.com/tyiannak/pyAudioAnalysis.git \"$LIBRARIES_DIR/pyAudioAnalysis\""
                    ],
                    "description": "Downloading PyAudioAnalysis",
                    "type": "commands"
                },
                {
                    "description": "Adding PyAudioAnalysis to PYTHON_PATH",
                    "commands": [
                        "export PYTHON_PATH=$PYTHON_PATH:\"$LIBRARIES_DIR/pyAudioAnalysis\""
                    ],
                    "type": "commands"
                },
                {
                    "description": "Applying fix to jupyter notebooks so they work with Docker",
                    "path": "/root/.jupyter/",
                    "permissions": "700",
                    "type": "folder"
                },
                {
                    "contents": [
                        "c.NotebookApp.ip = '*'"
                    ],
                    "path": "/root/.jupyter/jupyter_notebook_config.py",
                    "type": "file"
                },
                {
                    "description": "Setting bash greeting",
                    "contents": [
                        "",
                        "echo -en \\\"\\e[0;35m\\\"",
                        "echo \\\"                                       _   _                 \\\"",
                        "echo \\\"  ___ _ ____   __          _ __  _   _| |_| |__   ___  _ __  \\\"",
                        "echo \\\" / _ \\ '_ \\ \\ / /  _____  | '_ \\| | | | __| '_ \\ / _ \\| '_ \\ \\\"",
                        "echo \\\"|  __/ | | \\ V /  |_____| | |_) | |_| | |_| | | | (_) | | | |\\\"",
                        "echo \\\" \\___|_| |_|\\_/           | .__/ \\__, |\\__|_| |_|\\___/|_| |_|\\\"",
                        "echo \\\"                          |_|    |___/                       \\\"",
                        "echo \\n",
                        "echo -en \\\"\\e[0;32m\\\"",
                        "echo -n \\\"Run \\\"",
                        "echo -en \\\"\\e[0;36m\\\"",
                        "echo -n \\\"jupyter notebook --no-browser --allow-root\\\"",
                        "echo -en \\\"\\e[0;32m\\\"",
                        "echo -n \\\" to get started (hit the up key)\\\"",
                        "echo \\n",
                        "echo -e \\\"\\e[0m\\\""
                    ],
                    "path": "$BASE_DIR/.bashrc",
                    "type": "file"
                },
                {
                    "contents": [
                        "jupyter notebook --no-browser --allow-root"
                    ],
                    "path": "$BASE_DIR/.bash_history",
                    "type": "file"
                },
                {
                    "type": "workdir",
                    "workdir": "$BASE_DIR"
                }
            ],
            "version": "1.0.2"
        },
        "username": "joris"
    },
    "service": {
        "filesystem": [
            {
                "on_setup": true,
                "path": "corpus",
                "type": "folder"
            },
            {
                "on_setup": true,
                "path": "models",
                "type": "folder"
            },
            {
                "on_setup": true,
                "path": "scripts",
                "type": "folder"
            },
            {
                "on_setup": true,
                "path": "downloads",
                "type": "folder"
            }
        ]
    },
    "version_control": {
        "ignore": [
            "corpus/*",
            "models/*",
            "scripts/*",
            "downloads/*"
        ],
        "root_folder": "$BASE_DIR",
        "type": "git"
    }
}